package com.pratilipi.api.impl.init;

import java.util.Map;
import java.util.logging.Logger;

import com.googlecode.objectify.ObjectifyService;
import com.pratilipi.api.GenericApi;
import com.pratilipi.api.annotation.Bind;
import com.pratilipi.api.annotation.Get;
import com.pratilipi.api.impl.init.shared.GetInitApiRequest;
import com.pratilipi.api.shared.GenericResponse;
import com.pratilipi.common.exception.InsufficientAccessException;
import com.pratilipi.common.exception.InvalidArgumentException;
import com.pratilipi.common.type.Language;
import com.pratilipi.data.type.gae.BlogPostEntity;

@SuppressWarnings("serial")
@Bind( uri = "/ofy" )
public class OfyTestApi extends GenericApi {
	
	private static final Logger logger =
			Logger.getLogger( OfyTestApi.class.getName() );

	@Get
	public GenericResponse get( GetInitApiRequest request ) throws InvalidArgumentException, InsufficientAccessException {

		Long[] ids = new Long[] {
				5099941856804864L,
				5760921997672448L,
				5749052167684096L,
				5669074709250048L,
				6024244882309120L,
				5748265047818240L,
				5759359539740672L,
				6270184209776640L,
				5177177846841344L,
				5918426052689920L,
				5909783303421952L,
				5655030875029504L,
				5694451963920384L,
				5689676966920192L,
				5653109414035456L,
				5690005330591744L,
				5133244961914880L,
				5729270190047232L,
				6023373981220864L,
				5850981375934464L,
				6494199167844352L,
				5707929437077504L,
				5710994332450816L,
				5742576132947968L,
				5688547054977024L,
				6326249873997824L,
				6202389056978944L,
				6069047368089600L,
				5071915286790144L,
				4532828641427456L,
				5768167469088768L,
				6294304720945152L,
				5666818588934144L,
				5744250071285760L,
				5738981085937664L,
				5633999334539264L,
				5206351051489280L,
				5643998823710720L,
				5633165842448384L,
				5664507292549120L,
				4651206345490432L,
				5644943397748736L,
				5642980933238784L,
				5664618441605120L,
				5702516595490816L,
				5068162005467136L,
				5730634941071360L,
				5669448836972544L,
				5700272475078656L,
				5131930592870400L,
				5743509239758848L,
				6270466293497856L,
				5690130849333248L,
				5634425391939584L,
				5765586848055296L,
				5767216922361856L,
				5114273848098816L,
				5695886373945344L,
				5690638058127360L,
				5736201084469248L,
				5734348074516480L,
				5115330275835904L,
				5740809047506944L,
				5680391541227520L,
				5633226290757632L,
				5672201038594048L,
				5719794846269440L,
				5175142527270912L,
				5749689764806656L,
				5734665096790016L,
				5182591409848320L,
				5747442087624704L,
				5753177815121920L,
				5142105437503488L,
				5705819022688256L,
				5658155958665216L,
				5641799917895680L,
				5733754362396672L,
				5768820354449408L,
				5105201467883520L,
				5705311142805504L,
				5664164282368000L,
				5680905863561216L,
				5681841629560832L,
				6265244955443200L,
				5733235208224768L,
				5673461879930880L,
				5677303661068288L,
				5720239442493440L,
				5681162219421696L,
				5155364404199424L,
				4849957869715456L,
				5655266787852288L,
				5171951567896576L,
				5711832983535616L,
				5645175091101696L,
				5683887510388736L,
				5705591590748160L,
				5102675356024832L,
				5756433131896832L,
				5141776738287616L,
				6261594971439104L,
				4846024753414144L,
				5073650503909376L,
				5671744966754304L,
				5678807906254848L
		};
		
		Map<Long, BlogPostEntity> blogPosts = ObjectifyService.ofy().load().type( BlogPostEntity.class ).ids( ids );
		for( Long id : ids )
			blogPosts.get( id ).setLanguage( Language.GUJARATI );
		
		ObjectifyService.ofy().save().entities( blogPosts.values() ).now();
		
		return new GenericResponse();
	}

}