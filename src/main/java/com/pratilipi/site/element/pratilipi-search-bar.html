<dom-module id="pratilipi-search-bar">
	<style>
		:host {
			display: block;
			position: relative;
			background: #FFF;
			border-bottom: 1px solid #d3d3d3;
			padding-top: 64px;
		}
		paper-input.search {
			font-size: 14px;
	        --paper-input-container-focus-color: #797979;
		}
		paper-input.search /deep/ ::-webkit-input-placeholder {
			font-size: 14px;
			font-family: inherit;
		}
		paper-input.search /deep/ ::-moz-placeholder {
			font-size: 14px;
			font-family: inherit;
		}
		paper-input.search /deep/ :-ms-input-placeholder {
			font-size: 14px;
			font-family: inherit;
		}

		.flex-container {
			display: flex;
		}
		form {
			margin-top: -40px;
			margin-left: 4px;
			margin-right: 8px;
			flex-grow: 1;
		}
		.pratilipi-text {
			font-weight: bold;
			text-align: center;
			white-space: nowrap;
		}
		iron-icon {
			margin-left: -8px;
		}
		paper-menu {
			margin-left: 8px;
			padding: 0;
			width: 100px;
		}
		paper-menu-button {
			cursor: pointer;
			padding-top: 0;
		}
		paper-menu-button.language {
			--iron-dropdown: {
				top: 0;
			}
		}
	</style>
	<template>
		<div class="flex-container">
			<paper-menu-button no-animations vertical-offset=36 class="language" horizontal-align="left" vertical-align="top">
				<div class="pratilipi-red pratilipi-text dropdown-trigger">
					${ _strings.pratilipi }
					<iron-icon icon="icons:arrow-drop-down"></iron-icon>
				</div>
				<paper-menu class="dropdown-content">
					<paper-item>Hindi</paper-item>
					<paper-item>Gujarati</paper-item>
					<paper-item>Tamil</paper-item>
				</paper-menu>
			</paper-menu-button>
			<form id="searchBarForm" action="javascript:void(0);" on-keyup="onSubmit">
				<paper-input id="searchBarInput" name="q" class="search" type="search" placeholder="${ _strings.search }" onfocus="this.placeholder = ''" onblur="this.placeholder = '${ _strings.search_bar_help }'" value="{{ query::input }}">
					<paper-icon-button suffix icon="icons:search" noink="true" on-click="onSubmit"></paper-icon-button>
				</paper-input>
			</form>
		</div>
	</template>
	<script>
		Polymer({

		is: 'pratilipi-search-bar',

		properties: {
			query: { type: String },
		},

		onSubmit: function( event ) {
			if( event.keyCode != null && event.keyCode != 0 && event.keyCode != 13 || this.query == null || this.query.trim() == "" )
				return;
			var str = decodeURI( window.location.pathname );
			if( str == "/search" ) {
				document.querySelector( 'pratilipi-card-grid' ).setSearchQuery( this.query );
			} else {
				jQuery( "#searchBarForm" ).prop( "action", "/search" );
				jQuery( "#searchBarForm" ).submit();
			}
		}

		});
	</script>
</dom-module>