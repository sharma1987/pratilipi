<dom-module id="pratilipi-search-bar">

	<template>
		<form method="get" action="/search" on-submit="onSubmit">
			<div class="input-group">
				<input class="form-control" name="q" placeholder="${ _strings.search_bar_help }" value="{{ query::input }}" />
				<span class="input-group-btn">
					<button class="btn yellow" type="submit">
						&nbsp;<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
						&nbsp; ${ _strings.search } &nbsp;&nbsp;
					</button>
				</span>
			</div>
		</form>
	</template>


	<script>

		Polymer({
			
			is: 'pratilipi-search-bar',
			
			properties: {
				query: { type: String }
			},

			onSubmit: function( event ) {
				var searchResult = jQuery( '#SearchResult' )[0];
				if( searchResult != undefined ) {
					searchResult.search( this.query.trim() );
					event.preventDefault();
				} else if( this.query == undefined || this.query.trim() == '' ) {
					event.preventDefault();
				} else {
					this.query = this.query.trim();
				}
			},
			
			ready: function() {
			    var reParam = new RegExp( '(?:[\?&]|&)q=([^&]+)', 'i' );
			    var match = window.location.search.match( reParam ) ;
			    if( match && match.length > 1 )
			    	this.query = decodeURIComponent( match[ 1 ] ).split("+").join(" ");;
			}
			
		});

	</script>

</dom-module>