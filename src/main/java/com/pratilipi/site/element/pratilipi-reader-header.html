<dom-module id="pratilipi-reader-header">
	
	<style>
		paper-card {
			height: 64px;
			width: 100%;
			opacity: 0.96;
			padding: 10px 15px;
			--paper-card-header: { display: none };
		}
		.container, .container div {
			display: inline-block;
		}
		paper-icon-button {
			width: 45px;
			height: 45px;
		}
		paper-item {
			font-size: 13px;
			font-family: inherit;
		}
	</style>

	<template>
		<paper-card>
			<table style="min-width: 100%;">
				<tr>
					<td align="left">
						<!-- Back Button -->
						<paper-icon-button icon="icons:arrow-back" on-click="exitReader"></paper-icon-button>
						<!-- Index Button if content has Index -->
						<template is="dom-if" if="{{ !hideIndexButton }}">
							<div class="dropdown" style="display: inline-block;">
								<paper-icon-button icon="icons:view-list" data-toggle="dropdown"></paper-icon-button>
								<ul class="dropdown-menu" style="margin-top: 13px; max-height: 600px; overflow: scroll;">
									<template is="dom-repeat" items="{{ index }}">
										<pratilipi-reader-navigation-entry entry="{{ item }}" page-no="{{ pageNo }}"></pratilipi-reader-navigation-entry>
									</template>
								</ul>
							</div>
						</template>
					</td>
					<td align="right">
						
						<!-- Increase and Decrease font-size buttons -->
						<paper-icon-button icon="icons:add" on-click="increaseFontSize"></paper-icon-button>
						<paper-icon-button icon="icons:remove" on-click="decreaseFontSize"></paper-icon-button>
						
						<!-- Library Section -->
						<div class="dropdown" style="display: inline-block;">
							<paper-icon-button icon="icons:chrome-reader-mode" data-toggle="dropdown"></paper-icon-button>
							<ul class="dropdown-menu pull-right" style="margin-top: 13px;">
								<template is="dom-if" if="{{ !addedToLib }}">
									<li>
										<a style="padding: 5px; margin: 0;">
											<paper-item on-click="addToLibrary">
												<paper-icon-item><iron-icon icon="icons:add-circle"></iron-icon></paper-icon-item>
												&nbsp;&nbsp;
												<paper-item-body>${ _strings.add_to_library }</paper-item-body>
											</paper-item>
										</a>
									</li>
								</template>
								<template is="dom-if" if="{{ addedToLib }}">
									<li>
										<a style="padding: 5px; margin: 0;">
											<paper-item on-click="removeFromLibrary">
												<paper-icon-item><iron-icon icon="icons:remove-circle"></iron-icon></paper-icon-item>
												&nbsp;&nbsp;
												<paper-item-body>${ _strings.remove_from_library }</paper-item-body>
											</paper-item>
										</a>
									</li>
								</template>
								<li>
									<a style="padding: 5px; margin: 0;">
										<paper-item on-click="goToLibrary">
											<paper-icon-item><iron-icon icon="icons:list"></iron-icon></paper-icon-item>
											&nbsp;&nbsp;
											<paper-item-body>${ _strings.my_library }</paper-item-body>
										</paper-item>
									</a>
								</li>
							</ul>
						</div>
						
						<!-- Share widget -->
						<div class="dropdown" style="display: inline-block;">
							<paper-icon-button icon="icons:supervisor-account" data-toggle="dropdown"></paper-icon-button>
							<ul class="dropdown-menu pull-right" style="margin-top: 13px;">
								<li>
									<a style="padding: 5px; margin: 0;">
										<paper-item on-click="shareOnFacebook">
											<paper-icon-item style="width: 24px"><i class="fa fa-facebook fa-sm fb"></i></paper-icon-item>
											&nbsp;&nbsp;
											<paper-item-body>${ _strings.share_on_facebook }</paper-item-body>
										</paper-item>
									</a>
								</li>
								<li>
									<a style="padding: 5px; margin: 0;">
										<paper-item on-click="shareOnTwitter">
											<paper-icon-item style="width: 24px"><i class="fa fa-twitter fa-sm tw"></i></paper-icon-item>
											&nbsp;&nbsp;
											<paper-item-body>${ _strings.share_on_twitter }</paper-item-body>
										</paper-item>
									</a>
								</li>
								<li>
									<a style="padding: 5px; margin: 0;">
										<paper-item on-click="shareOnGplus">
											<paper-icon-item style="width: 24px"><i class="fa fa-google-plus fa-sm google"></i></paper-icon-item>
											&nbsp;&nbsp;
											<paper-item-body>${ _strings.share_on_gplus }</paper-item-body>
										</paper-item>
									</a>
								</li>
							</ul>
						</div>
						
						<!-- Menu button -->
						<div class="dropdown" style="display: inline-block;">
							<paper-icon-button icon="icons:more-vert" data-toggle="dropdown"></paper-icon-button>
							<ul class="dropdown-menu pull-right" style="margin-top: 13px;">
								<li>
									<paper-item style="padding: 5px 15px; margin: 0;">
										<h6 class="pratilipi-red text-center" style="text-align: center;">{{ title }}</h6>
									</paper-item>
								</li>
								<template is="dom-if" if="{{ hasAccessToUpdate }}">
									<li>
										<a style="padding: 5px; margin: 0;">
											<paper-item on-click="redirectToWriterPanel">
												<paper-icon-item><iron-icon icon="icons:create"></iron-icon></paper-icon-item>
												&nbsp;&nbsp;
												<paper-item-body>${ _strings.pratilipi_edit_content }</paper-item-body>
											</paper-item>
										</a>
									</li>
								</template>
								<template is="dom-if" if="{{ !hasAccessToUpdate }}">
									<li>
										<a style="padding: 5px; margin: 0;">
											<paper-item on-click=writeReview>
												<paper-icon-item><iron-icon icon="icons:create"></iron-icon></paper-icon-item>
												&nbsp;&nbsp;
												<paper-item-body>${ _strings.review_write_a_review }</paper-item-body>
											</paper-item>
										</a>
									</li>
								</template>
								<li>
									<a style="padding: 5px; margin: 0;" href="{{ pratilipi.author.pageUrl }}">
										<paper-item>
											<paper-icon-item><iron-icon icon="icons:account-box"></iron-icon></paper-icon-item>
											&nbsp;&nbsp;
											<paper-item-body>${ _strings.reader_goto_author_profile }</paper-item-body>
										</paper-item>
									</a>
								</li>
								<li>
									<a style="padding: 5px; margin: 0;" href="/">
										<paper-item>
											<paper-icon-item><iron-icon icon="icons:home"></iron-icon></paper-icon-item>
											&nbsp;&nbsp;
											<paper-item-body>${ _strings.reader_goto_home_page }</paper-item-body>
										</paper-item>
									</a>
								</li>
							</ul>
						</div>
					</td>
				</tr>
			</table>
		</paper-card>
	</template>

	<script>
	
		Polymer({

			is: 'pratilipi-reader-header',
			
			properties: {
				pratilipi: { type: Object },
				hasAccessToUpdate: { type: Boolean },
				addedToLib: { type: Boolean, value: false },
				hideIndexButton: { type: Boolean },
				index: { type: Array },
				pageNo: { type: Number }
			},
			
			ready: function() {
				this.title = 	this.pratilipi.title != null && this.pratilipi.title.trim() != "" ?
								this.pratilipi.title : this.pratilipi.titleEn;
			},
			
			shareOnFacebook: function() {
				window.open( "http://www.facebook.com/sharer.php?u=" + "http://${ domain }/read?id=" + this.pratilipi.pratilipiId, "share", "width=1100,height=500,left=70px,top=60px" );
			},
			
			shareOnTwitter: function() {
				window.open( "http://twitter.com/share?url=" + "http://${ domain }/read?id=" + this.pratilipi.pratilipiId, "share", "width=1100,height=500,left=70px,top=60px" );
			},
			
			shareOnGplus: function() {
				window.open( "https://plus.google.com/share?url=" + "http://${ domain }/read?id=" + this.pratilipi.pratilipiId, "share", "width=1100,height=500,left=70px,top=60px" );
			},
			
			closeNavigation: function() {
				document.querySelector( 'pratilipi-reader-navigation' ).closeNavigation();
			},
			
			increaseFontSize: function() {
				document.querySelector( 'pratilipi-reader-page' ).increaseFontSize();
			},
			
			decreaseFontSize: function() {
				document.querySelector( 'pratilipi-reader-page' ).decreaseFontSize();
			},
			
			addToLibrary: function() {
				document.querySelector( 'pratilipi-reader-page' ).addToLibrary();
			},
			
			removeFromLibrary: function() {
				document.querySelector( 'pratilipi-reader-page' ).removeFromLibrary();
			},
			
			goToLibrary: function() {
				document.querySelector( 'pratilipi-reader-page' ).goToLibrary();
			},
			
			openNavigation: function() {
				document.querySelector( 'pratilipi-reader-navigation' ).toggleNavigation();
			},
			
			writeReview: function() {
				document.querySelector( 'pratilipi-reader-page' ).writeReview();
			},
			
			redirectToWriterPanel: function() {
				document.querySelector( 'pratilipi-reader-page' ).redirectToWriterPanel();
			},
			
			exitReader: function() {
				document.querySelector( 'pratilipi-reader-page' ).exitReader();
			}
			
		});
	</script>

</dom-module>

<dom-module id="pratilipi-reader-navigation-entry">
	<style>
		a.heading, a.heading:hover, a.heading:focus {
			font-weight: 600;
		}
		a.grey, a.grey:hover, a.grey:focus {
			color: #707070;
		}
		a.black, a.black:hover, a.black:focus {
			color: #333;
		}
		a.blue, a.blue:hover, a.blue:focus {
			color: #107FE5;
		}
	</style>
	<template>
		<a id="entry" on-click="_entrySelected">
			<li style="margin: 24px 18px; max-width: 275px;">
					[[ entry.title ]]
			</li>
		</a>
	</template>
	<script>
		Polymer({
			is: 'pratilipi-reader-navigation-entry',
			
			properties: {
				entry: { type: Object },
				pageNo: { type: Number, observer: "_pageNoChanged" }
			},
			
			attached: function() {
				if( this.entry.level == 0 )
					jQuery( this.querySelector( '#entry' ) ).addClass( "heading" );
			},
			
			_pageNoChanged: function() {
				if( this.pageNo == this.entry.pageNo ) {
					jQuery( this.querySelector( '#entry' ) ).removeClass( "black" );
					jQuery( this.querySelector( '#entry' ) ).removeClass( "grey" );
					jQuery( this.querySelector( '#entry' ) ).addClass( "blue" );
				} else {
					jQuery( this.querySelector( '#entry' ) ).removeClass( "blue" );
					if( this.entry.level == 0 )
						jQuery( this.querySelector( '#entry' ) ).addClass( "black" );
					else
						jQuery( this.querySelector( '#entry' ) ).addClass( "grey" );
				}
			},
			
			_entrySelected: function() {
				document.querySelector( 'pratilipi-reader-page' ).setPageNo( this.entry.pageNo );
			} 
		
		});
	</script>
</dom-module>