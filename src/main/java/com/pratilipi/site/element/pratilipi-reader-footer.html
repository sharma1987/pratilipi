<dom-module id="pratilipi-reader-footer">

	<style>
		:host {
			display: block;
		}
		paper-slider.pratilipi-slider {
			--paper-slider-active-color: #D0021B;
			--paper-slider-knob-color: #D0021B;
			--paper-slider-knob-start-color: #D0021B;
		}
		paper-fab.pratilipi-red {
			--paper-fab-background: #FFF;
			--paper-fab-keyboard-focus-background: #FFF;
		}
	</style>


	<template>
		<div class="parent-container margin-top-bottom">
			<div class="container" style="text-align: center;">
				<paper-input type="number" 
							style="display: inline-block; width: 75px;" 
							value="{{ pageNoInput }}" 
							on-change="_inputObserver">
					<div suffix>/ {{ pageCount }}</div>
				</paper-input>
			</div>
			<div class="horizontal layout center">
				<paper-slider
						class="flex pratilipi-slider"
						min="1" max="{{ pageCount }}"
						value="{{ pageNoSlider }}"
						on-change="_sliderObserver"
						disabled="{{ sliderDisabled }}"></paper-slider>
				<paper-fab
						class="pratilipi-red"
						mini style="margin-right:10px"
						icon="icons:chevron-left" title="Previous Page"
						disabled="{{ prevButtonDisabled }}"
						on-click="showPrevious"></paper-fab>
				<paper-fab
						class="pratilipi-red"
						mini style="margin-right:10px"
						icon="icons:chevron-right" title="Next Page"
						disabled="{{ nextButtonDisabled }}"
						on-click="showNext"></paper-fab>
			</div>
		</div>
	</template>
	
	
	<script>

		Polymer({

			is: 'pratilipi-reader-footer',
			
			properties: {
				pageNo: { type:Number, observer: "_pageNoChanged" },
				pageNoInput: { type: Number },
				pageNoSlider: { type: Number },
				pageCount: { type:Number },
				sliderDisabled: { type:Boolean },
				prevButtonDisabled: { type:Boolean },
				nextButtonDisabled: { type:Boolean },
				a11yKeysTarget: {
					type: Object,
					value: function() {
						return window;
					}
				},
			},
			
			_pageNoChanged: function() {
				if( this.pageCount == null || this.pageNo == null )
					return;
				
				this.pageNoInput = this.pageNo;
				this.pageNoSlider = this.pageNo;
				this.prevButtonDisabled = this.pageNo <= 1;
				this.nextButtonDisabled = ( this.pageCount <= 1 || this.pageNo >= this.pageCount );
			},

			showPrevious: function() {
				document.querySelector( 'pratilipi-reader-page' ).setPageNo( this.pageNo - 1 );
			},
			
			showNext: function() {
				document.querySelector( 'pratilipi-reader-page' ).setPageNo( this.pageNo + 1 );
			},
			
			ready: function() {
				this.sliderDisabled = this.pageCount <= 1;
				this._pageNoChanged();
			},
			
			_inputObserver: function() {
				if( this.pageNoInput >= 1 && this.pageNoInput <= this.pageCount && this.pageNo != this.pageNoInput )
					document.querySelector( 'pratilipi-reader-page' ).setPageNo( this.pageNoInput );
				else
					this.pageNoInput = this.pageNo;
			},
			
			_sliderObserver: function() {
				if( this.pageNo != this.pageNoSlider )
					document.querySelector( 'pratilipi-reader-page' ).setPageNo( this.pageNoSlider );
			}
			
		});

	</script>

</dom-module>