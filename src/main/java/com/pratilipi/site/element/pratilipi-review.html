<link rel="import" href="pratilipi-rating.html">

<dom-module id="pratilipi-review">

	<style>
		
		:host {
			display: block;
		}
		
		paper-card {
			width: 100%;
			padding: 10px;
		}
		
		iron-icon, .user-dp {
			width: 64px; 
			height: 64px; 
			display: block; 
			margin: 10px auto;
			color: #989898;
		}

	</style>

	
	<template>
		<template is="dom-if" if="{{ !hideReview }}">
			<paper-card>
				<div class="row" style="padding: 10px;">
					<div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="text-align: center; padding-top: 7px;">
						<small><pratilipi-rating value="{{ review.rating }}" /></small>
			   			<template is="dom-if" if="{{ reviewUserImageUrl }}">
			   				<img class="img-circle user-dp" src="{{ reviewUserImageUrl }}" alt="{{ user.userName }}" title="{{ user.userName }}"/>
			   			</template>
			   			<template is="dom-if" if="{{ !review.userImageUrl }}">
			   				<iron-icon icon="account-circle"></iron-icon>
			   			</template>
			   			<span>{{ review.userName }}</span>
			   			<br/>
			   			<span>{{ reviewDateMillis }}</span>
					</div>
					<div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
						<h4 class="pratilipi-red">{{ review.reviewTitle }}</h4>
						<div class="review" style="text-align: justify;"></div>
					</div>
				</div>
			</paper-card>
		</template>
	</template>
	

	<script>
	
		Polymer({

			is: 'pratilipi-review',
			
			properties: {
				review: { type: Object, observer: "ready" },
				hideReview: { type: Boolean, value: false }
			},
			
			ready: function() {
				
				if( ( this.reviewTitle == null || this.reviewTitle.trim() == "" )
						&& ( this.review == null || this.review.trim() == "" ) ) {
					this.hideReview = true;
					return;
				}
					
				if( this.review.review )
					jQuery( this.querySelector( '.review' ) ).html( this.review.review );
				
				if( this.review.userImageUrl ) {
					if( this.review.userImageUrl.indexOf( '?' ) == -1 )
						this.reviewUserImageUrl = this.review.userImageUrl + "?" + "width=64";
					else
						this.reviewUserImageUrl = this.review.userImageUrl + "&" + "width=64";
				}
				
				if( this.review.reviewDateMillis )
					this.reviewDateMillis = convertDate( this.review.reviewDateMillis );
			}

		});
		
	</script>

</dom-module>
